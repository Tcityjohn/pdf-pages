# Grandma's Guidance

Last reviewed: 2026-01-17T22:00:00Z
Last story reviewed: PDF-005

---

## Current Assessment

**5 of 18 stories completed.** Project continues on excellent trajectory. PDF-005 (Thumbnail Generation) passes all acceptance criteria with clean implementation.

Ralph's work quality remains high:
- Precise implementation following guidance
- Proper memory management (try-finally for page cleanup)
- Correct use of pdfx API (1-indexed pages, PdfPageImageFormat enum)
- Clean code with no analyzer warnings
- Fast build time (7.2s)

Current codebase state:
- `lib/main.dart` - HomePage with file picker, shows page count after loading
- `lib/core/services/pdf_service.dart` - PdfService with loadPdf(), generateThumbnail(), closeDocument()
- PdfService keeps `currentDocument` reference for thumbnail generation
- Thumbnail generation ready for UI integration (PDF-007)

## Guidance for PDF-006: Home Screen UI

**This is your next story.** Build the home screen that matches the mockup.

### Implementation Approach

1. **Read the mockup first:**
   - Open `./mockups/01-home-screen.html` in a browser to see the target design
   - Note exact colors, spacing, icon sizes, typography

2. **Create the UI in main.dart:**
   - Replace the current simple UI with the full home screen design
   - Use Material 3 components (ElevatedButton, Card, etc.)
   - Match all design specifications exactly

### Design Specifications

**Colors:**
- Primary: `Color(0xFFE53935)` (red)
- Primary container: `Color(0xFFFFCDD2)` (light red)
- Background: White
- Text: Dark grey/black

**Layout:**
- Centered content
- PDF icon in colored circle at top
- Title: "Extract PDF Pages" (large, bold)
- Subtitle: Explanation text (regular weight)
- Privacy badge with lock icon
- Select PDF button with folder icon at bottom
- Settings gear icon in app bar (top right)

**Spacing:**
- Use 12px grid for padding and margins
- 8px or 12px border radius on buttons/cards
- Consistent vertical spacing between elements

**Icons:**
- PDF icon: `Icons.picture_as_pdf`
- Lock icon: `Icons.lock_outline`
- Folder icon: `Icons.folder_open`
- Settings icon: `Icons.settings`

### Testing Requirements

Test on these iOS Simulator devices:
- iPhone SE (3rd gen) - smallest screen
- iPhone 15 - standard size
- iPhone 15 Pro Max - largest screen

Verify:
- Layout doesn't overflow on small screens
- Text is readable
- Buttons are tappable
- Spacing looks balanced
- Colors match mockup exactly

### Don't Over-Engineer

- Don't add functionality yet - just the UI
- File picker integration already exists - keep it
- Settings icon doesn't need to navigate anywhere yet (PDF-017)
- Focus on matching the mockup pixel-perfect

### Acceptance Criteria Checklist

- [ ] UI matches mockups/01-home-screen.html
- [ ] PDF icon displayed in colored circle
- [ ] Title: 'Extract PDF Pages'
- [ ] Subtitle explaining the feature
- [ ] Privacy badge with lock icon
- [ ] Select PDF button with folder icon
- [ ] Settings gear icon in app bar
- [ ] Responsive layout works on different iOS device sizes

---

## Patterns for This Project

- Primary color: `Color(0xFFE53935)`
- pdfx uses 1-indexed pages
- Always close PdfPage after use to free memory
- iOS deployment target: 14.0
- Use Material 3 components
- 12px spacing grid, 8px/12px border radius

---

## History

| Story | Status | Notes |
|-------|--------|-------|
| PDF-001 | ✅ Pass | Project scaffolding |
| PDF-002 | ✅ Pass | iOS permissions |
| PDF-003 | ✅ Pass | File picker |
| PDF-004 | ✅ Pass | PDF loading service |
| PDF-005 | ✅ Pass | Thumbnail generation |

### Iteration 5 Review - PDF-005: Thumbnail Generation
**Status:** ✅ PASS

**What Ralph did well:**
- Added `dart:typed_data` import correctly
- Implemented `generateThumbnail(int pageNumber)` method exactly as specified
- Used 1-indexed page number (following pdfx convention)
- Renders at 150px width × 212px height (~1.4 aspect ratio)
- Returns `Uint8List` containing PNG bytes
- Proper memory management: try-finally ensures page.close() always runs
- Throws `PdfLoadException` if no document loaded
- Clean documentation with doc comments

**Issues encountered:**
- None. Clean implementation with no errors.

**Acceptance criteria verification:**
1. ✅ generateThumbnail() method renders page at 150px width - Confirmed: width: 150, height: 212
2. ✅ Thumbnails maintain correct aspect ratio (~1.4 for A4) - Confirmed: 212/150 = 1.413
3. ✅ Returns Uint8List (PNG bytes) - Confirmed: return type and pageImage!.bytes
4. ✅ Generation is async - Confirmed: async method with await
5. ✅ Memory usage reasonable - Confirmed: page.close() in finally block

**Quality checks:**
- flutter analyze: No issues found (3.5s)
- flutter build ios --simulator: Build succeeded (7.2s)
- Code follows project patterns
- Proper null safety
- Clear error handling

**Notes for future:**
- Method is ready for UI integration in PDF-007 (Page grid with thumbnails)
- Ralph correctly followed guidance to NOT integrate with UI yet
- Memory management pattern is exemplary - always use try-finally for cleanup
- Fast build time (7.2s) indicates clean codebase

---

*Guidance updated: 2026-01-17T22:00:00Z*
